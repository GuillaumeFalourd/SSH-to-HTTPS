name: Action test on Ubuntu

on:
  push:
  workflow_dispatch:

jobs:
  test-without-credential:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2.3.4
        with:
          persist-credentials: false
      - run: git config --list
      - name: Reconfigure git to use HTTP authentication
        uses: GuillaumeFalourd/SSH-to-HTTP@main
      - run: git config --list

  test-with-credential:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2.3.4
        with:
          persist-credentials: false
      - run: git config --list
      - name: Reconfigure git to use HTTP authentication
        uses: GuillaumeFalourd/SSH-to-HTTP@main
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
      - run: git config --list